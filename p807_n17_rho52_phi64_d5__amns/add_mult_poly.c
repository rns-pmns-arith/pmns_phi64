#include "p__conv_data.h"


void add_poly(int64_t *rop, int64_t *pa, int64_t *pb){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = pa[j] + pb[j];
}

void sub_poly(int64_t *rop, int64_t *pa, int64_t *pb){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = pa[j] - pb[j];
}

//~ computes : pa + 2.pb
void double_add_poly(int64_t *rop, int64_t *pa, int64_t *pb){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = pa[j] + 2*pb[j];
}

//~ computes : pa - 2.pb
void double_sub_poly(int64_t *rop, int64_t *pa, int64_t *pb){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = pa[j] - 2*pb[j];
}

void neg_poly(int64_t *rop, int64_t *op){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = -op[j];
}

//~ assumes 'scalar' and/or coeffs of 'op' small enough to avoid an overflow.
void scalar_mult_poly(int64_t *rop, int64_t *op, int64_t scalar){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = scalar * op[j];
}

//~ assumes 'scalar' and/or coeffs of 'op' small enough to avoid an overflow.
void double_poly_coeffs(int64_t *rop, int64_t *op){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = op[j] << 1;
}

//~ assumes 'nb_pos' and/or coeffs of 'op' small enough to avoid an overflow.
void lshift_poly_coeffs(int64_t *rop, int64_t *op, int nb_pos){
	int j;
	for (j=0; j<NB_COEFF; j++)
		rop[j] = op[j] << nb_pos;
}

//~ Computes pa(X)*pb(X) mod(E)
void mult_mod_poly(int64_t *rop, int64_t *pa, int64_t *pb){

	int128 tmp_prod_result[NB_COEFF];

	tmp_prod_result[0] = (int128)pa[0] * pb[0] + (((int128)pa[1] * pb[16] + (int128)pa[2] * pb[15] + (int128)pa[3] * pb[14] + (int128)pa[4] * pb[13] + (int128)pa[5] * pb[12] + (int128)pa[6] * pb[11] + (int128)pa[7] * pb[10] + (int128)pa[8] * pb[9] + (int128)pa[9] * pb[8] + (int128)pa[10] * pb[7] + (int128)pa[11] * pb[6] + (int128)pa[12] * pb[5] + (int128)pa[13] * pb[4] + (int128)pa[14] * pb[3] + (int128)pa[15] * pb[2] + (int128)pa[16] * pb[1]) << 1);
	tmp_prod_result[1] = (int128)pa[0] * pb[1] + (int128)pa[1] * pb[0] + (((int128)pa[2] * pb[16] + (int128)pa[3] * pb[15] + (int128)pa[4] * pb[14] + (int128)pa[5] * pb[13] + (int128)pa[6] * pb[12] + (int128)pa[7] * pb[11] + (int128)pa[8] * pb[10] + (int128)pa[9] * pb[9] + (int128)pa[10] * pb[8] + (int128)pa[11] * pb[7] + (int128)pa[12] * pb[6] + (int128)pa[13] * pb[5] + (int128)pa[14] * pb[4] + (int128)pa[15] * pb[3] + (int128)pa[16] * pb[2]) << 1);
	tmp_prod_result[2] = (int128)pa[0] * pb[2] + (int128)pa[1] * pb[1] + (int128)pa[2] * pb[0] + (((int128)pa[3] * pb[16] + (int128)pa[4] * pb[15] + (int128)pa[5] * pb[14] + (int128)pa[6] * pb[13] + (int128)pa[7] * pb[12] + (int128)pa[8] * pb[11] + (int128)pa[9] * pb[10] + (int128)pa[10] * pb[9] + (int128)pa[11] * pb[8] + (int128)pa[12] * pb[7] + (int128)pa[13] * pb[6] + (int128)pa[14] * pb[5] + (int128)pa[15] * pb[4] + (int128)pa[16] * pb[3]) << 1);
	tmp_prod_result[3] = (int128)pa[0] * pb[3] + (int128)pa[1] * pb[2] + (int128)pa[2] * pb[1] + (int128)pa[3] * pb[0] + (((int128)pa[4] * pb[16] + (int128)pa[5] * pb[15] + (int128)pa[6] * pb[14] + (int128)pa[7] * pb[13] + (int128)pa[8] * pb[12] + (int128)pa[9] * pb[11] + (int128)pa[10] * pb[10] + (int128)pa[11] * pb[9] + (int128)pa[12] * pb[8] + (int128)pa[13] * pb[7] + (int128)pa[14] * pb[6] + (int128)pa[15] * pb[5] + (int128)pa[16] * pb[4]) << 1);
	tmp_prod_result[4] = (int128)pa[0] * pb[4] + (int128)pa[1] * pb[3] + (int128)pa[2] * pb[2] + (int128)pa[3] * pb[1] + (int128)pa[4] * pb[0] + (((int128)pa[5] * pb[16] + (int128)pa[6] * pb[15] + (int128)pa[7] * pb[14] + (int128)pa[8] * pb[13] + (int128)pa[9] * pb[12] + (int128)pa[10] * pb[11] + (int128)pa[11] * pb[10] + (int128)pa[12] * pb[9] + (int128)pa[13] * pb[8] + (int128)pa[14] * pb[7] + (int128)pa[15] * pb[6] + (int128)pa[16] * pb[5]) << 1);
	tmp_prod_result[5] = (int128)pa[0] * pb[5] + (int128)pa[1] * pb[4] + (int128)pa[2] * pb[3] + (int128)pa[3] * pb[2] + (int128)pa[4] * pb[1] + (int128)pa[5] * pb[0] + (((int128)pa[6] * pb[16] + (int128)pa[7] * pb[15] + (int128)pa[8] * pb[14] + (int128)pa[9] * pb[13] + (int128)pa[10] * pb[12] + (int128)pa[11] * pb[11] + (int128)pa[12] * pb[10] + (int128)pa[13] * pb[9] + (int128)pa[14] * pb[8] + (int128)pa[15] * pb[7] + (int128)pa[16] * pb[6]) << 1);
	tmp_prod_result[6] = (int128)pa[0] * pb[6] + (int128)pa[1] * pb[5] + (int128)pa[2] * pb[4] + (int128)pa[3] * pb[3] + (int128)pa[4] * pb[2] + (int128)pa[5] * pb[1] + (int128)pa[6] * pb[0] + (((int128)pa[7] * pb[16] + (int128)pa[8] * pb[15] + (int128)pa[9] * pb[14] + (int128)pa[10] * pb[13] + (int128)pa[11] * pb[12] + (int128)pa[12] * pb[11] + (int128)pa[13] * pb[10] + (int128)pa[14] * pb[9] + (int128)pa[15] * pb[8] + (int128)pa[16] * pb[7]) << 1);
	tmp_prod_result[7] = (int128)pa[0] * pb[7] + (int128)pa[1] * pb[6] + (int128)pa[2] * pb[5] + (int128)pa[3] * pb[4] + (int128)pa[4] * pb[3] + (int128)pa[5] * pb[2] + (int128)pa[6] * pb[1] + (int128)pa[7] * pb[0] + (((int128)pa[8] * pb[16] + (int128)pa[9] * pb[15] + (int128)pa[10] * pb[14] + (int128)pa[11] * pb[13] + (int128)pa[12] * pb[12] + (int128)pa[13] * pb[11] + (int128)pa[14] * pb[10] + (int128)pa[15] * pb[9] + (int128)pa[16] * pb[8]) << 1);
	tmp_prod_result[8] = (int128)pa[0] * pb[8] + (int128)pa[1] * pb[7] + (int128)pa[2] * pb[6] + (int128)pa[3] * pb[5] + (int128)pa[4] * pb[4] + (int128)pa[5] * pb[3] + (int128)pa[6] * pb[2] + (int128)pa[7] * pb[1] + (int128)pa[8] * pb[0] + (((int128)pa[9] * pb[16] + (int128)pa[10] * pb[15] + (int128)pa[11] * pb[14] + (int128)pa[12] * pb[13] + (int128)pa[13] * pb[12] + (int128)pa[14] * pb[11] + (int128)pa[15] * pb[10] + (int128)pa[16] * pb[9]) << 1);
	tmp_prod_result[9] = (int128)pa[0] * pb[9] + (int128)pa[1] * pb[8] + (int128)pa[2] * pb[7] + (int128)pa[3] * pb[6] + (int128)pa[4] * pb[5] + (int128)pa[5] * pb[4] + (int128)pa[6] * pb[3] + (int128)pa[7] * pb[2] + (int128)pa[8] * pb[1] + (int128)pa[9] * pb[0] + (((int128)pa[10] * pb[16] + (int128)pa[11] * pb[15] + (int128)pa[12] * pb[14] + (int128)pa[13] * pb[13] + (int128)pa[14] * pb[12] + (int128)pa[15] * pb[11] + (int128)pa[16] * pb[10]) << 1);
	tmp_prod_result[10] = (int128)pa[0] * pb[10] + (int128)pa[1] * pb[9] + (int128)pa[2] * pb[8] + (int128)pa[3] * pb[7] + (int128)pa[4] * pb[6] + (int128)pa[5] * pb[5] + (int128)pa[6] * pb[4] + (int128)pa[7] * pb[3] + (int128)pa[8] * pb[2] + (int128)pa[9] * pb[1] + (int128)pa[10] * pb[0] + (((int128)pa[11] * pb[16] + (int128)pa[12] * pb[15] + (int128)pa[13] * pb[14] + (int128)pa[14] * pb[13] + (int128)pa[15] * pb[12] + (int128)pa[16] * pb[11]) << 1);
	tmp_prod_result[11] = (int128)pa[0] * pb[11] + (int128)pa[1] * pb[10] + (int128)pa[2] * pb[9] + (int128)pa[3] * pb[8] + (int128)pa[4] * pb[7] + (int128)pa[5] * pb[6] + (int128)pa[6] * pb[5] + (int128)pa[7] * pb[4] + (int128)pa[8] * pb[3] + (int128)pa[9] * pb[2] + (int128)pa[10] * pb[1] + (int128)pa[11] * pb[0] + (((int128)pa[12] * pb[16] + (int128)pa[13] * pb[15] + (int128)pa[14] * pb[14] + (int128)pa[15] * pb[13] + (int128)pa[16] * pb[12]) << 1);
	tmp_prod_result[12] = (int128)pa[0] * pb[12] + (int128)pa[1] * pb[11] + (int128)pa[2] * pb[10] + (int128)pa[3] * pb[9] + (int128)pa[4] * pb[8] + (int128)pa[5] * pb[7] + (int128)pa[6] * pb[6] + (int128)pa[7] * pb[5] + (int128)pa[8] * pb[4] + (int128)pa[9] * pb[3] + (int128)pa[10] * pb[2] + (int128)pa[11] * pb[1] + (int128)pa[12] * pb[0] + (((int128)pa[13] * pb[16] + (int128)pa[14] * pb[15] + (int128)pa[15] * pb[14] + (int128)pa[16] * pb[13]) << 1);
	tmp_prod_result[13] = (int128)pa[0] * pb[13] + (int128)pa[1] * pb[12] + (int128)pa[2] * pb[11] + (int128)pa[3] * pb[10] + (int128)pa[4] * pb[9] + (int128)pa[5] * pb[8] + (int128)pa[6] * pb[7] + (int128)pa[7] * pb[6] + (int128)pa[8] * pb[5] + (int128)pa[9] * pb[4] + (int128)pa[10] * pb[3] + (int128)pa[11] * pb[2] + (int128)pa[12] * pb[1] + (int128)pa[13] * pb[0] + (((int128)pa[14] * pb[16] + (int128)pa[15] * pb[15] + (int128)pa[16] * pb[14]) << 1);
	tmp_prod_result[14] = (int128)pa[0] * pb[14] + (int128)pa[1] * pb[13] + (int128)pa[2] * pb[12] + (int128)pa[3] * pb[11] + (int128)pa[4] * pb[10] + (int128)pa[5] * pb[9] + (int128)pa[6] * pb[8] + (int128)pa[7] * pb[7] + (int128)pa[8] * pb[6] + (int128)pa[9] * pb[5] + (int128)pa[10] * pb[4] + (int128)pa[11] * pb[3] + (int128)pa[12] * pb[2] + (int128)pa[13] * pb[1] + (int128)pa[14] * pb[0] + (((int128)pa[15] * pb[16] + (int128)pa[16] * pb[15]) << 1);
	tmp_prod_result[15] = (int128)pa[0] * pb[15] + (int128)pa[1] * pb[14] + (int128)pa[2] * pb[13] + (int128)pa[3] * pb[12] + (int128)pa[4] * pb[11] + (int128)pa[5] * pb[10] + (int128)pa[6] * pb[9] + (int128)pa[7] * pb[8] + (int128)pa[8] * pb[7] + (int128)pa[9] * pb[6] + (int128)pa[10] * pb[5] + (int128)pa[11] * pb[4] + (int128)pa[12] * pb[3] + (int128)pa[13] * pb[2] + (int128)pa[14] * pb[1] + (int128)pa[15] * pb[0] + (((int128)pa[16] * pb[16]) << 1);
	tmp_prod_result[16] = (int128)pa[0] * pb[16] + (int128)pa[1] * pb[15] + (int128)pa[2] * pb[14] + (int128)pa[3] * pb[13] + (int128)pa[4] * pb[12] + (int128)pa[5] * pb[11] + (int128)pa[6] * pb[10] + (int128)pa[7] * pb[9] + (int128)pa[8] * pb[8] + (int128)pa[9] * pb[7] + (int128)pa[10] * pb[6] + (int128)pa[11] * pb[5] + (int128)pa[12] * pb[4] + (int128)pa[13] * pb[3] + (int128)pa[14] * pb[2] + (int128)pa[15] * pb[1] + (int128)pa[16] * pb[0];

	internal_reduction(rop, tmp_prod_result);
}

//~ Computes pa(X)^2 mod(E)
void square_mod_poly(int64_t *rop, int64_t *pa){

	int128 tmp_prod_result[NB_COEFF];

	tmp_prod_result[0] = (int128)pa[0] * pa[0] + (((int128)pa[9] * pa[8] + (int128)pa[10] * pa[7] + (int128)pa[11] * pa[6] + (int128)pa[12] * pa[5] + (int128)pa[13] * pa[4] + (int128)pa[14] * pa[3] + (int128)pa[15] * pa[2] + (int128)pa[16] * pa[1]) << 2);
	tmp_prod_result[1] = (((int128)pa[1] * pa[0]) << 1) + (((((int128)pa[10] * pa[8] + (int128)pa[11] * pa[7] + (int128)pa[12] * pa[6] + (int128)pa[13] * pa[5] + (int128)pa[14] * pa[4] + (int128)pa[15] * pa[3] + (int128)pa[16] * pa[2]) << 1) + (int128)pa[9] * pa[9]) << 1);
	tmp_prod_result[2] = (((int128)pa[2] * pa[0]) << 1) + (int128)pa[1] * pa[1] + (((int128)pa[10] * pa[9] + (int128)pa[11] * pa[8] + (int128)pa[12] * pa[7] + (int128)pa[13] * pa[6] + (int128)pa[14] * pa[5] + (int128)pa[15] * pa[4] + (int128)pa[16] * pa[3]) << 2);
	tmp_prod_result[3] = (((int128)pa[2] * pa[1] + (int128)pa[3] * pa[0]) << 1) + (((((int128)pa[11] * pa[9] + (int128)pa[12] * pa[8] + (int128)pa[13] * pa[7] + (int128)pa[14] * pa[6] + (int128)pa[15] * pa[5] + (int128)pa[16] * pa[4]) << 1) + (int128)pa[10] * pa[10]) << 1);
	tmp_prod_result[4] = (((int128)pa[3] * pa[1] + (int128)pa[4] * pa[0]) << 1) + (int128)pa[2] * pa[2] + (((int128)pa[11] * pa[10] + (int128)pa[12] * pa[9] + (int128)pa[13] * pa[8] + (int128)pa[14] * pa[7] + (int128)pa[15] * pa[6] + (int128)pa[16] * pa[5]) << 2);
	tmp_prod_result[5] = (((int128)pa[3] * pa[2] + (int128)pa[4] * pa[1] + (int128)pa[5] * pa[0]) << 1) + (((((int128)pa[12] * pa[10] + (int128)pa[13] * pa[9] + (int128)pa[14] * pa[8] + (int128)pa[15] * pa[7] + (int128)pa[16] * pa[6]) << 1) + (int128)pa[11] * pa[11]) << 1);
	tmp_prod_result[6] = (((int128)pa[4] * pa[2] + (int128)pa[5] * pa[1] + (int128)pa[6] * pa[0]) << 1) + (int128)pa[3] * pa[3] + (((int128)pa[12] * pa[11] + (int128)pa[13] * pa[10] + (int128)pa[14] * pa[9] + (int128)pa[15] * pa[8] + (int128)pa[16] * pa[7]) << 2);
	tmp_prod_result[7] = (((int128)pa[4] * pa[3] + (int128)pa[5] * pa[2] + (int128)pa[6] * pa[1] + (int128)pa[7] * pa[0]) << 1) + (((((int128)pa[13] * pa[11] + (int128)pa[14] * pa[10] + (int128)pa[15] * pa[9] + (int128)pa[16] * pa[8]) << 1) + (int128)pa[12] * pa[12]) << 1);
	tmp_prod_result[8] = (((int128)pa[5] * pa[3] + (int128)pa[6] * pa[2] + (int128)pa[7] * pa[1] + (int128)pa[8] * pa[0]) << 1) + (int128)pa[4] * pa[4] + (((int128)pa[13] * pa[12] + (int128)pa[14] * pa[11] + (int128)pa[15] * pa[10] + (int128)pa[16] * pa[9]) << 2);
	tmp_prod_result[9] = (((int128)pa[5] * pa[4] + (int128)pa[6] * pa[3] + (int128)pa[7] * pa[2] + (int128)pa[8] * pa[1] + (int128)pa[9] * pa[0]) << 1) + (((((int128)pa[14] * pa[12] + (int128)pa[15] * pa[11] + (int128)pa[16] * pa[10]) << 1) + (int128)pa[13] * pa[13]) << 1);
	tmp_prod_result[10] = (((int128)pa[6] * pa[4] + (int128)pa[7] * pa[3] + (int128)pa[8] * pa[2] + (int128)pa[9] * pa[1] + (int128)pa[10] * pa[0]) << 1) + (int128)pa[5] * pa[5] + (((int128)pa[14] * pa[13] + (int128)pa[15] * pa[12] + (int128)pa[16] * pa[11]) << 2);
	tmp_prod_result[11] = (((int128)pa[6] * pa[5] + (int128)pa[7] * pa[4] + (int128)pa[8] * pa[3] + (int128)pa[9] * pa[2] + (int128)pa[10] * pa[1] + (int128)pa[11] * pa[0]) << 1) + (((((int128)pa[15] * pa[13] + (int128)pa[16] * pa[12]) << 1) + (int128)pa[14] * pa[14]) << 1);
	tmp_prod_result[12] = (((int128)pa[7] * pa[5] + (int128)pa[8] * pa[4] + (int128)pa[9] * pa[3] + (int128)pa[10] * pa[2] + (int128)pa[11] * pa[1] + (int128)pa[12] * pa[0]) << 1) + (int128)pa[6] * pa[6] + (((int128)pa[15] * pa[14] + (int128)pa[16] * pa[13]) << 2);
	tmp_prod_result[13] = (((int128)pa[7] * pa[6] + (int128)pa[8] * pa[5] + (int128)pa[9] * pa[4] + (int128)pa[10] * pa[3] + (int128)pa[11] * pa[2] + (int128)pa[12] * pa[1] + (int128)pa[13] * pa[0]) << 1) + (((((int128)pa[16] * pa[14]) << 1) + (int128)pa[15] * pa[15]) << 1);
	tmp_prod_result[14] = (((int128)pa[8] * pa[6] + (int128)pa[9] * pa[5] + (int128)pa[10] * pa[4] + (int128)pa[11] * pa[3] + (int128)pa[12] * pa[2] + (int128)pa[13] * pa[1] + (int128)pa[14] * pa[0]) << 1) + (int128)pa[7] * pa[7] + (((int128)pa[16] * pa[15]) << 2);
	tmp_prod_result[15] = (((int128)pa[8] * pa[7] + (int128)pa[9] * pa[6] + (int128)pa[10] * pa[5] + (int128)pa[11] * pa[4] + (int128)pa[12] * pa[3] + (int128)pa[13] * pa[2] + (int128)pa[14] * pa[1] + (int128)pa[15] * pa[0]) << 1) + (((int128)pa[16] * pa[16]) << 1);
	tmp_prod_result[16] = (((int128)pa[9] * pa[7] + (int128)pa[10] * pa[6] + (int128)pa[11] * pa[5] + (int128)pa[12] * pa[4] + (int128)pa[13] * pa[3] + (int128)pa[14] * pa[2] + (int128)pa[15] * pa[1] + (int128)pa[16] * pa[0]) << 1) + (int128)pa[8] * pa[8];

	internal_reduction(rop, tmp_prod_result);
}

//~ performs the internal reduction on 'op' and puts the result in 'rop'
//~ IMPORTANT : We take 'mont_phi = 1 << WORD_SIZE', so operations modulo mont_phi are automatically done using the appropriate variable type.
void internal_reduction(int64_t *rop, int128 *op){

	uint64_t tmpQ[17];
	int128 tmpZero[17];

	//~ computation of : op*neg_inv_ri_rep_coeff mod(E, mont_phi)
	tmpQ[0] = (uint64_t)op[0] * 0x72f182752c0cff9UL + (uint64_t)op[1] * 0x5fa32203c63dffdaUL + (uint64_t)op[2] * 0x6db0bacdf8cdd608UL + (uint64_t)op[3] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[4] * 0xc4a7893570f7c96cUL + (uint64_t)op[5] * 0xcabaf67347803156UL + (uint64_t)op[6] * 0x6782ce84565f8e06UL + (uint64_t)op[7] * 0xffc02b1aacfab40aUL + (uint64_t)op[8] * 0xe40992400071b4d0UL + (uint64_t)op[9] * 0x8fb1a1142cf72528UL + (uint64_t)op[10] * 0x67954ae10d82d57cUL + (uint64_t)op[11] * 0x3a8884932b251128UL + (uint64_t)op[12] * 0x9cea1d721719af1eUL + (uint64_t)op[13] * 0xb1324573a5989e00UL + (uint64_t)op[14] * 0x6f94c10d281e9772UL + (uint64_t)op[15] * 0x18b18e7b32f44452UL + (uint64_t)op[16] * 0xb40d07cfd0bc6558UL;
	tmpQ[1] = (uint64_t)op[0] * 0xda0683e7e85e32acUL + (uint64_t)op[1] * 0x72f182752c0cff9UL + (uint64_t)op[2] * 0x5fa32203c63dffdaUL + (uint64_t)op[3] * 0x6db0bacdf8cdd608UL + (uint64_t)op[4] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[5] * 0xc4a7893570f7c96cUL + (uint64_t)op[6] * 0xcabaf67347803156UL + (uint64_t)op[7] * 0x6782ce84565f8e06UL + (uint64_t)op[8] * 0xffc02b1aacfab40aUL + (uint64_t)op[9] * 0xe40992400071b4d0UL + (uint64_t)op[10] * 0x8fb1a1142cf72528UL + (uint64_t)op[11] * 0x67954ae10d82d57cUL + (uint64_t)op[12] * 0x3a8884932b251128UL + (uint64_t)op[13] * 0x9cea1d721719af1eUL + (uint64_t)op[14] * 0xb1324573a5989e00UL + (uint64_t)op[15] * 0x6f94c10d281e9772UL + (uint64_t)op[16] * 0x18b18e7b32f44452UL;
	tmpQ[2] = (uint64_t)op[0] * 0x8c58c73d997a2229UL + (uint64_t)op[1] * 0xda0683e7e85e32acUL + (uint64_t)op[2] * 0x72f182752c0cff9UL + (uint64_t)op[3] * 0x5fa32203c63dffdaUL + (uint64_t)op[4] * 0x6db0bacdf8cdd608UL + (uint64_t)op[5] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[6] * 0xc4a7893570f7c96cUL + (uint64_t)op[7] * 0xcabaf67347803156UL + (uint64_t)op[8] * 0x6782ce84565f8e06UL + (uint64_t)op[9] * 0xffc02b1aacfab40aUL + (uint64_t)op[10] * 0xe40992400071b4d0UL + (uint64_t)op[11] * 0x8fb1a1142cf72528UL + (uint64_t)op[12] * 0x67954ae10d82d57cUL + (uint64_t)op[13] * 0x3a8884932b251128UL + (uint64_t)op[14] * 0x9cea1d721719af1eUL + (uint64_t)op[15] * 0xb1324573a5989e00UL + (uint64_t)op[16] * 0x6f94c10d281e9772UL;
	tmpQ[3] = (uint64_t)op[0] * 0xb7ca6086940f4bb9UL + (uint64_t)op[1] * 0x8c58c73d997a2229UL + (uint64_t)op[2] * 0xda0683e7e85e32acUL + (uint64_t)op[3] * 0x72f182752c0cff9UL + (uint64_t)op[4] * 0x5fa32203c63dffdaUL + (uint64_t)op[5] * 0x6db0bacdf8cdd608UL + (uint64_t)op[6] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[7] * 0xc4a7893570f7c96cUL + (uint64_t)op[8] * 0xcabaf67347803156UL + (uint64_t)op[9] * 0x6782ce84565f8e06UL + (uint64_t)op[10] * 0xffc02b1aacfab40aUL + (uint64_t)op[11] * 0xe40992400071b4d0UL + (uint64_t)op[12] * 0x8fb1a1142cf72528UL + (uint64_t)op[13] * 0x67954ae10d82d57cUL + (uint64_t)op[14] * 0x3a8884932b251128UL + (uint64_t)op[15] * 0x9cea1d721719af1eUL + (uint64_t)op[16] * 0xb1324573a5989e00UL;
	tmpQ[4] = (uint64_t)op[0] * 0x589922b9d2cc4f00UL + (uint64_t)op[1] * 0xb7ca6086940f4bb9UL + (uint64_t)op[2] * 0x8c58c73d997a2229UL + (uint64_t)op[3] * 0xda0683e7e85e32acUL + (uint64_t)op[4] * 0x72f182752c0cff9UL + (uint64_t)op[5] * 0x5fa32203c63dffdaUL + (uint64_t)op[6] * 0x6db0bacdf8cdd608UL + (uint64_t)op[7] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[8] * 0xc4a7893570f7c96cUL + (uint64_t)op[9] * 0xcabaf67347803156UL + (uint64_t)op[10] * 0x6782ce84565f8e06UL + (uint64_t)op[11] * 0xffc02b1aacfab40aUL + (uint64_t)op[12] * 0xe40992400071b4d0UL + (uint64_t)op[13] * 0x8fb1a1142cf72528UL + (uint64_t)op[14] * 0x67954ae10d82d57cUL + (uint64_t)op[15] * 0x3a8884932b251128UL + (uint64_t)op[16] * 0x9cea1d721719af1eUL;
	tmpQ[5] = (uint64_t)op[0] * 0xce750eb90b8cd78fUL + (uint64_t)op[1] * 0x589922b9d2cc4f00UL + (uint64_t)op[2] * 0xb7ca6086940f4bb9UL + (uint64_t)op[3] * 0x8c58c73d997a2229UL + (uint64_t)op[4] * 0xda0683e7e85e32acUL + (uint64_t)op[5] * 0x72f182752c0cff9UL + (uint64_t)op[6] * 0x5fa32203c63dffdaUL + (uint64_t)op[7] * 0x6db0bacdf8cdd608UL + (uint64_t)op[8] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[9] * 0xc4a7893570f7c96cUL + (uint64_t)op[10] * 0xcabaf67347803156UL + (uint64_t)op[11] * 0x6782ce84565f8e06UL + (uint64_t)op[12] * 0xffc02b1aacfab40aUL + (uint64_t)op[13] * 0xe40992400071b4d0UL + (uint64_t)op[14] * 0x8fb1a1142cf72528UL + (uint64_t)op[15] * 0x67954ae10d82d57cUL + (uint64_t)op[16] * 0x3a8884932b251128UL;
	tmpQ[6] = (uint64_t)op[0] * 0x9d44424995928894UL + (uint64_t)op[1] * 0xce750eb90b8cd78fUL + (uint64_t)op[2] * 0x589922b9d2cc4f00UL + (uint64_t)op[3] * 0xb7ca6086940f4bb9UL + (uint64_t)op[4] * 0x8c58c73d997a2229UL + (uint64_t)op[5] * 0xda0683e7e85e32acUL + (uint64_t)op[6] * 0x72f182752c0cff9UL + (uint64_t)op[7] * 0x5fa32203c63dffdaUL + (uint64_t)op[8] * 0x6db0bacdf8cdd608UL + (uint64_t)op[9] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[10] * 0xc4a7893570f7c96cUL + (uint64_t)op[11] * 0xcabaf67347803156UL + (uint64_t)op[12] * 0x6782ce84565f8e06UL + (uint64_t)op[13] * 0xffc02b1aacfab40aUL + (uint64_t)op[14] * 0xe40992400071b4d0UL + (uint64_t)op[15] * 0x8fb1a1142cf72528UL + (uint64_t)op[16] * 0x67954ae10d82d57cUL;
	tmpQ[7] = (uint64_t)op[0] * 0xb3caa57086c16abeUL + (uint64_t)op[1] * 0x9d44424995928894UL + (uint64_t)op[2] * 0xce750eb90b8cd78fUL + (uint64_t)op[3] * 0x589922b9d2cc4f00UL + (uint64_t)op[4] * 0xb7ca6086940f4bb9UL + (uint64_t)op[5] * 0x8c58c73d997a2229UL + (uint64_t)op[6] * 0xda0683e7e85e32acUL + (uint64_t)op[7] * 0x72f182752c0cff9UL + (uint64_t)op[8] * 0x5fa32203c63dffdaUL + (uint64_t)op[9] * 0x6db0bacdf8cdd608UL + (uint64_t)op[10] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[11] * 0xc4a7893570f7c96cUL + (uint64_t)op[12] * 0xcabaf67347803156UL + (uint64_t)op[13] * 0x6782ce84565f8e06UL + (uint64_t)op[14] * 0xffc02b1aacfab40aUL + (uint64_t)op[15] * 0xe40992400071b4d0UL + (uint64_t)op[16] * 0x8fb1a1142cf72528UL;
	tmpQ[8] = (uint64_t)op[0] * 0xc7d8d08a167b9294UL + (uint64_t)op[1] * 0xb3caa57086c16abeUL + (uint64_t)op[2] * 0x9d44424995928894UL + (uint64_t)op[3] * 0xce750eb90b8cd78fUL + (uint64_t)op[4] * 0x589922b9d2cc4f00UL + (uint64_t)op[5] * 0xb7ca6086940f4bb9UL + (uint64_t)op[6] * 0x8c58c73d997a2229UL + (uint64_t)op[7] * 0xda0683e7e85e32acUL + (uint64_t)op[8] * 0x72f182752c0cff9UL + (uint64_t)op[9] * 0x5fa32203c63dffdaUL + (uint64_t)op[10] * 0x6db0bacdf8cdd608UL + (uint64_t)op[11] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[12] * 0xc4a7893570f7c96cUL + (uint64_t)op[13] * 0xcabaf67347803156UL + (uint64_t)op[14] * 0x6782ce84565f8e06UL + (uint64_t)op[15] * 0xffc02b1aacfab40aUL + (uint64_t)op[16] * 0xe40992400071b4d0UL;
	tmpQ[9] = (uint64_t)op[0] * 0x7204c9200038da68UL + (uint64_t)op[1] * 0xc7d8d08a167b9294UL + (uint64_t)op[2] * 0xb3caa57086c16abeUL + (uint64_t)op[3] * 0x9d44424995928894UL + (uint64_t)op[4] * 0xce750eb90b8cd78fUL + (uint64_t)op[5] * 0x589922b9d2cc4f00UL + (uint64_t)op[6] * 0xb7ca6086940f4bb9UL + (uint64_t)op[7] * 0x8c58c73d997a2229UL + (uint64_t)op[8] * 0xda0683e7e85e32acUL + (uint64_t)op[9] * 0x72f182752c0cff9UL + (uint64_t)op[10] * 0x5fa32203c63dffdaUL + (uint64_t)op[11] * 0x6db0bacdf8cdd608UL + (uint64_t)op[12] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[13] * 0xc4a7893570f7c96cUL + (uint64_t)op[14] * 0xcabaf67347803156UL + (uint64_t)op[15] * 0x6782ce84565f8e06UL + (uint64_t)op[16] * 0xffc02b1aacfab40aUL;
	tmpQ[10] = (uint64_t)op[0] * 0xffe0158d567d5a05UL + (uint64_t)op[1] * 0x7204c9200038da68UL + (uint64_t)op[2] * 0xc7d8d08a167b9294UL + (uint64_t)op[3] * 0xb3caa57086c16abeUL + (uint64_t)op[4] * 0x9d44424995928894UL + (uint64_t)op[5] * 0xce750eb90b8cd78fUL + (uint64_t)op[6] * 0x589922b9d2cc4f00UL + (uint64_t)op[7] * 0xb7ca6086940f4bb9UL + (uint64_t)op[8] * 0x8c58c73d997a2229UL + (uint64_t)op[9] * 0xda0683e7e85e32acUL + (uint64_t)op[10] * 0x72f182752c0cff9UL + (uint64_t)op[11] * 0x5fa32203c63dffdaUL + (uint64_t)op[12] * 0x6db0bacdf8cdd608UL + (uint64_t)op[13] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[14] * 0xc4a7893570f7c96cUL + (uint64_t)op[15] * 0xcabaf67347803156UL + (uint64_t)op[16] * 0x6782ce84565f8e06UL;
	tmpQ[11] = (uint64_t)op[0] * 0xb3c167422b2fc703UL + (uint64_t)op[1] * 0xffe0158d567d5a05UL + (uint64_t)op[2] * 0x7204c9200038da68UL + (uint64_t)op[3] * 0xc7d8d08a167b9294UL + (uint64_t)op[4] * 0xb3caa57086c16abeUL + (uint64_t)op[5] * 0x9d44424995928894UL + (uint64_t)op[6] * 0xce750eb90b8cd78fUL + (uint64_t)op[7] * 0x589922b9d2cc4f00UL + (uint64_t)op[8] * 0xb7ca6086940f4bb9UL + (uint64_t)op[9] * 0x8c58c73d997a2229UL + (uint64_t)op[10] * 0xda0683e7e85e32acUL + (uint64_t)op[11] * 0x72f182752c0cff9UL + (uint64_t)op[12] * 0x5fa32203c63dffdaUL + (uint64_t)op[13] * 0x6db0bacdf8cdd608UL + (uint64_t)op[14] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[15] * 0xc4a7893570f7c96cUL + (uint64_t)op[16] * 0xcabaf67347803156UL;
	tmpQ[12] = (uint64_t)op[0] * 0xe55d7b39a3c018abUL + (uint64_t)op[1] * 0xb3c167422b2fc703UL + (uint64_t)op[2] * 0xffe0158d567d5a05UL + (uint64_t)op[3] * 0x7204c9200038da68UL + (uint64_t)op[4] * 0xc7d8d08a167b9294UL + (uint64_t)op[5] * 0xb3caa57086c16abeUL + (uint64_t)op[6] * 0x9d44424995928894UL + (uint64_t)op[7] * 0xce750eb90b8cd78fUL + (uint64_t)op[8] * 0x589922b9d2cc4f00UL + (uint64_t)op[9] * 0xb7ca6086940f4bb9UL + (uint64_t)op[10] * 0x8c58c73d997a2229UL + (uint64_t)op[11] * 0xda0683e7e85e32acUL + (uint64_t)op[12] * 0x72f182752c0cff9UL + (uint64_t)op[13] * 0x5fa32203c63dffdaUL + (uint64_t)op[14] * 0x6db0bacdf8cdd608UL + (uint64_t)op[15] * 0x1415e3c5fdb8d38eUL + (uint64_t)op[16] * 0xc4a7893570f7c96cUL;
	tmpQ[13] = (uint64_t)op[0] * 0xe253c49ab87be4b6UL + (uint64_t)op[1] * 0xe55d7b39a3c018abUL + (uint64_t)op[2] * 0xb3c167422b2fc703UL + (uint64_t)op[3] * 0xffe0158d567d5a05UL + (uint64_t)op[4] * 0x7204c9200038da68UL + (uint64_t)op[5] * 0xc7d8d08a167b9294UL + (uint64_t)op[6] * 0xb3caa57086c16abeUL + (uint64_t)op[7] * 0x9d44424995928894UL + (uint64_t)op[8] * 0xce750eb90b8cd78fUL + (uint64_t)op[9] * 0x589922b9d2cc4f00UL + (uint64_t)op[10] * 0xb7ca6086940f4bb9UL + (uint64_t)op[11] * 0x8c58c73d997a2229UL + (uint64_t)op[12] * 0xda0683e7e85e32acUL + (uint64_t)op[13] * 0x72f182752c0cff9UL + (uint64_t)op[14] * 0x5fa32203c63dffdaUL + (uint64_t)op[15] * 0x6db0bacdf8cdd608UL + (uint64_t)op[16] * 0x1415e3c5fdb8d38eUL;
	tmpQ[14] = (uint64_t)op[0] * 0xa0af1e2fedc69c7UL + (uint64_t)op[1] * 0xe253c49ab87be4b6UL + (uint64_t)op[2] * 0xe55d7b39a3c018abUL + (uint64_t)op[3] * 0xb3c167422b2fc703UL + (uint64_t)op[4] * 0xffe0158d567d5a05UL + (uint64_t)op[5] * 0x7204c9200038da68UL + (uint64_t)op[6] * 0xc7d8d08a167b9294UL + (uint64_t)op[7] * 0xb3caa57086c16abeUL + (uint64_t)op[8] * 0x9d44424995928894UL + (uint64_t)op[9] * 0xce750eb90b8cd78fUL + (uint64_t)op[10] * 0x589922b9d2cc4f00UL + (uint64_t)op[11] * 0xb7ca6086940f4bb9UL + (uint64_t)op[12] * 0x8c58c73d997a2229UL + (uint64_t)op[13] * 0xda0683e7e85e32acUL + (uint64_t)op[14] * 0x72f182752c0cff9UL + (uint64_t)op[15] * 0x5fa32203c63dffdaUL + (uint64_t)op[16] * 0x6db0bacdf8cdd608UL;
	tmpQ[15] = (uint64_t)op[0] * 0xb6d85d66fc66eb04UL + (uint64_t)op[1] * 0xa0af1e2fedc69c7UL + (uint64_t)op[2] * 0xe253c49ab87be4b6UL + (uint64_t)op[3] * 0xe55d7b39a3c018abUL + (uint64_t)op[4] * 0xb3c167422b2fc703UL + (uint64_t)op[5] * 0xffe0158d567d5a05UL + (uint64_t)op[6] * 0x7204c9200038da68UL + (uint64_t)op[7] * 0xc7d8d08a167b9294UL + (uint64_t)op[8] * 0xb3caa57086c16abeUL + (uint64_t)op[9] * 0x9d44424995928894UL + (uint64_t)op[10] * 0xce750eb90b8cd78fUL + (uint64_t)op[11] * 0x589922b9d2cc4f00UL + (uint64_t)op[12] * 0xb7ca6086940f4bb9UL + (uint64_t)op[13] * 0x8c58c73d997a2229UL + (uint64_t)op[14] * 0xda0683e7e85e32acUL + (uint64_t)op[15] * 0x72f182752c0cff9UL + (uint64_t)op[16] * 0x5fa32203c63dffdaUL;
	tmpQ[16] = (uint64_t)op[0] * 0xafd19101e31effedUL + (uint64_t)op[1] * 0xb6d85d66fc66eb04UL + (uint64_t)op[2] * 0xa0af1e2fedc69c7UL + (uint64_t)op[3] * 0xe253c49ab87be4b6UL + (uint64_t)op[4] * 0xe55d7b39a3c018abUL + (uint64_t)op[5] * 0xb3c167422b2fc703UL + (uint64_t)op[6] * 0xffe0158d567d5a05UL + (uint64_t)op[7] * 0x7204c9200038da68UL + (uint64_t)op[8] * 0xc7d8d08a167b9294UL + (uint64_t)op[9] * 0xb3caa57086c16abeUL + (uint64_t)op[10] * 0x9d44424995928894UL + (uint64_t)op[11] * 0xce750eb90b8cd78fUL + (uint64_t)op[12] * 0x589922b9d2cc4f00UL + (uint64_t)op[13] * 0xb7ca6086940f4bb9UL + (uint64_t)op[14] * 0x8c58c73d997a2229UL + (uint64_t)op[15] * 0xda0683e7e85e32acUL + (uint64_t)op[16] * 0x72f182752c0cff9UL;

	//~ computation of : tmp_q*red_int_coeff mod(E)
	tmpZero[0] = (int128)tmpQ[0] * 0x497e98f70c47L + (int128)tmpQ[1] * 0x5fd612626f6cL + (int128)tmpQ[2] * -0xb6f7c3eba830L + (int128)tmpQ[3] * 0x6ab7650a4baeL + (int128)tmpQ[4] * -0x1964a2e3beb8L + (int128)tmpQ[5] * 0x6eaa78fb7420L + (int128)tmpQ[6] * -0x7c8a225b899aL + (int128)tmpQ[7] * 0x595e7a3b6c86L + (int128)tmpQ[8] * 0x46772ef702ecL + (int128)tmpQ[9] * -0x201f2b1ae02cL + (int128)tmpQ[10] * -0x3e2d858e8a12L + (int128)tmpQ[11] * -0x19b798253674L + (int128)tmpQ[12] * -0x2ee776f56152L + (int128)tmpQ[13] * 0x4463b1ec3c92L + (int128)tmpQ[14] * 0x620b65d32a2eL + (int128)tmpQ[15] * 0x3d8558d820c2L + (int128)tmpQ[16] * 0x104290765c4cL;
	tmpZero[1] = (int128)tmpQ[0] * 0x821483b2e26L + (int128)tmpQ[1] * 0x497e98f70c47L + (int128)tmpQ[2] * 0x5fd612626f6cL + (int128)tmpQ[3] * -0xb6f7c3eba830L + (int128)tmpQ[4] * 0x6ab7650a4baeL + (int128)tmpQ[5] * -0x1964a2e3beb8L + (int128)tmpQ[6] * 0x6eaa78fb7420L + (int128)tmpQ[7] * -0x7c8a225b899aL + (int128)tmpQ[8] * 0x595e7a3b6c86L + (int128)tmpQ[9] * 0x46772ef702ecL + (int128)tmpQ[10] * -0x201f2b1ae02cL + (int128)tmpQ[11] * -0x3e2d858e8a12L + (int128)tmpQ[12] * -0x19b798253674L + (int128)tmpQ[13] * -0x2ee776f56152L + (int128)tmpQ[14] * 0x4463b1ec3c92L + (int128)tmpQ[15] * 0x620b65d32a2eL + (int128)tmpQ[16] * 0x3d8558d820c2L;
	tmpZero[2] = (int128)tmpQ[0] * 0x1ec2ac6c1061L + (int128)tmpQ[1] * 0x821483b2e26L + (int128)tmpQ[2] * 0x497e98f70c47L + (int128)tmpQ[3] * 0x5fd612626f6cL + (int128)tmpQ[4] * -0xb6f7c3eba830L + (int128)tmpQ[5] * 0x6ab7650a4baeL + (int128)tmpQ[6] * -0x1964a2e3beb8L + (int128)tmpQ[7] * 0x6eaa78fb7420L + (int128)tmpQ[8] * -0x7c8a225b899aL + (int128)tmpQ[9] * 0x595e7a3b6c86L + (int128)tmpQ[10] * 0x46772ef702ecL + (int128)tmpQ[11] * -0x201f2b1ae02cL + (int128)tmpQ[12] * -0x3e2d858e8a12L + (int128)tmpQ[13] * -0x19b798253674L + (int128)tmpQ[14] * -0x2ee776f56152L + (int128)tmpQ[15] * 0x4463b1ec3c92L + (int128)tmpQ[16] * 0x620b65d32a2eL;
	tmpZero[3] = (int128)tmpQ[0] * 0x3105b2e99517L + (int128)tmpQ[1] * 0x1ec2ac6c1061L + (int128)tmpQ[2] * 0x821483b2e26L + (int128)tmpQ[3] * 0x497e98f70c47L + (int128)tmpQ[4] * 0x5fd612626f6cL + (int128)tmpQ[5] * -0xb6f7c3eba830L + (int128)tmpQ[6] * 0x6ab7650a4baeL + (int128)tmpQ[7] * -0x1964a2e3beb8L + (int128)tmpQ[8] * 0x6eaa78fb7420L + (int128)tmpQ[9] * -0x7c8a225b899aL + (int128)tmpQ[10] * 0x595e7a3b6c86L + (int128)tmpQ[11] * 0x46772ef702ecL + (int128)tmpQ[12] * -0x201f2b1ae02cL + (int128)tmpQ[13] * -0x3e2d858e8a12L + (int128)tmpQ[14] * -0x19b798253674L + (int128)tmpQ[15] * -0x2ee776f56152L + (int128)tmpQ[16] * 0x4463b1ec3c92L;
	tmpZero[4] = (int128)tmpQ[0] * 0x2231d8f61e49L + (int128)tmpQ[1] * 0x3105b2e99517L + (int128)tmpQ[2] * 0x1ec2ac6c1061L + (int128)tmpQ[3] * 0x821483b2e26L + (int128)tmpQ[4] * 0x497e98f70c47L + (int128)tmpQ[5] * 0x5fd612626f6cL + (int128)tmpQ[6] * -0xb6f7c3eba830L + (int128)tmpQ[7] * 0x6ab7650a4baeL + (int128)tmpQ[8] * -0x1964a2e3beb8L + (int128)tmpQ[9] * 0x6eaa78fb7420L + (int128)tmpQ[10] * -0x7c8a225b899aL + (int128)tmpQ[11] * 0x595e7a3b6c86L + (int128)tmpQ[12] * 0x46772ef702ecL + (int128)tmpQ[13] * -0x201f2b1ae02cL + (int128)tmpQ[14] * -0x3e2d858e8a12L + (int128)tmpQ[15] * -0x19b798253674L + (int128)tmpQ[16] * -0x2ee776f56152L;
	tmpZero[5] = (int128)tmpQ[0] * -0x1773bb7ab0a9L + (int128)tmpQ[1] * 0x2231d8f61e49L + (int128)tmpQ[2] * 0x3105b2e99517L + (int128)tmpQ[3] * 0x1ec2ac6c1061L + (int128)tmpQ[4] * 0x821483b2e26L + (int128)tmpQ[5] * 0x497e98f70c47L + (int128)tmpQ[6] * 0x5fd612626f6cL + (int128)tmpQ[7] * -0xb6f7c3eba830L + (int128)tmpQ[8] * 0x6ab7650a4baeL + (int128)tmpQ[9] * -0x1964a2e3beb8L + (int128)tmpQ[10] * 0x6eaa78fb7420L + (int128)tmpQ[11] * -0x7c8a225b899aL + (int128)tmpQ[12] * 0x595e7a3b6c86L + (int128)tmpQ[13] * 0x46772ef702ecL + (int128)tmpQ[14] * -0x201f2b1ae02cL + (int128)tmpQ[15] * -0x3e2d858e8a12L + (int128)tmpQ[16] * -0x19b798253674L;
	tmpZero[6] = (int128)tmpQ[0] * -0xcdbcc129b3aL + (int128)tmpQ[1] * -0x1773bb7ab0a9L + (int128)tmpQ[2] * 0x2231d8f61e49L + (int128)tmpQ[3] * 0x3105b2e99517L + (int128)tmpQ[4] * 0x1ec2ac6c1061L + (int128)tmpQ[5] * 0x821483b2e26L + (int128)tmpQ[6] * 0x497e98f70c47L + (int128)tmpQ[7] * 0x5fd612626f6cL + (int128)tmpQ[8] * -0xb6f7c3eba830L + (int128)tmpQ[9] * 0x6ab7650a4baeL + (int128)tmpQ[10] * -0x1964a2e3beb8L + (int128)tmpQ[11] * 0x6eaa78fb7420L + (int128)tmpQ[12] * -0x7c8a225b899aL + (int128)tmpQ[13] * 0x595e7a3b6c86L + (int128)tmpQ[14] * 0x46772ef702ecL + (int128)tmpQ[15] * -0x201f2b1ae02cL + (int128)tmpQ[16] * -0x3e2d858e8a12L;
	tmpZero[7] = (int128)tmpQ[0] * -0x1f16c2c74509L + (int128)tmpQ[1] * -0xcdbcc129b3aL + (int128)tmpQ[2] * -0x1773bb7ab0a9L + (int128)tmpQ[3] * 0x2231d8f61e49L + (int128)tmpQ[4] * 0x3105b2e99517L + (int128)tmpQ[5] * 0x1ec2ac6c1061L + (int128)tmpQ[6] * 0x821483b2e26L + (int128)tmpQ[7] * 0x497e98f70c47L + (int128)tmpQ[8] * 0x5fd612626f6cL + (int128)tmpQ[9] * -0xb6f7c3eba830L + (int128)tmpQ[10] * 0x6ab7650a4baeL + (int128)tmpQ[11] * -0x1964a2e3beb8L + (int128)tmpQ[12] * 0x6eaa78fb7420L + (int128)tmpQ[13] * -0x7c8a225b899aL + (int128)tmpQ[14] * 0x595e7a3b6c86L + (int128)tmpQ[15] * 0x46772ef702ecL + (int128)tmpQ[16] * -0x201f2b1ae02cL;
	tmpZero[8] = (int128)tmpQ[0] * -0x100f958d7016L + (int128)tmpQ[1] * -0x1f16c2c74509L + (int128)tmpQ[2] * -0xcdbcc129b3aL + (int128)tmpQ[3] * -0x1773bb7ab0a9L + (int128)tmpQ[4] * 0x2231d8f61e49L + (int128)tmpQ[5] * 0x3105b2e99517L + (int128)tmpQ[6] * 0x1ec2ac6c1061L + (int128)tmpQ[7] * 0x821483b2e26L + (int128)tmpQ[8] * 0x497e98f70c47L + (int128)tmpQ[9] * 0x5fd612626f6cL + (int128)tmpQ[10] * -0xb6f7c3eba830L + (int128)tmpQ[11] * 0x6ab7650a4baeL + (int128)tmpQ[12] * -0x1964a2e3beb8L + (int128)tmpQ[13] * 0x6eaa78fb7420L + (int128)tmpQ[14] * -0x7c8a225b899aL + (int128)tmpQ[15] * 0x595e7a3b6c86L + (int128)tmpQ[16] * 0x46772ef702ecL;
	tmpZero[9] = (int128)tmpQ[0] * 0x233b977b8176L + (int128)tmpQ[1] * -0x100f958d7016L + (int128)tmpQ[2] * -0x1f16c2c74509L + (int128)tmpQ[3] * -0xcdbcc129b3aL + (int128)tmpQ[4] * -0x1773bb7ab0a9L + (int128)tmpQ[5] * 0x2231d8f61e49L + (int128)tmpQ[6] * 0x3105b2e99517L + (int128)tmpQ[7] * 0x1ec2ac6c1061L + (int128)tmpQ[8] * 0x821483b2e26L + (int128)tmpQ[9] * 0x497e98f70c47L + (int128)tmpQ[10] * 0x5fd612626f6cL + (int128)tmpQ[11] * -0xb6f7c3eba830L + (int128)tmpQ[12] * 0x6ab7650a4baeL + (int128)tmpQ[13] * -0x1964a2e3beb8L + (int128)tmpQ[14] * 0x6eaa78fb7420L + (int128)tmpQ[15] * -0x7c8a225b899aL + (int128)tmpQ[16] * 0x595e7a3b6c86L;
	tmpZero[10] = (int128)tmpQ[0] * 0x2caf3d1db643L + (int128)tmpQ[1] * 0x233b977b8176L + (int128)tmpQ[2] * -0x100f958d7016L + (int128)tmpQ[3] * -0x1f16c2c74509L + (int128)tmpQ[4] * -0xcdbcc129b3aL + (int128)tmpQ[5] * -0x1773bb7ab0a9L + (int128)tmpQ[6] * 0x2231d8f61e49L + (int128)tmpQ[7] * 0x3105b2e99517L + (int128)tmpQ[8] * 0x1ec2ac6c1061L + (int128)tmpQ[9] * 0x821483b2e26L + (int128)tmpQ[10] * 0x497e98f70c47L + (int128)tmpQ[11] * 0x5fd612626f6cL + (int128)tmpQ[12] * -0xb6f7c3eba830L + (int128)tmpQ[13] * 0x6ab7650a4baeL + (int128)tmpQ[14] * -0x1964a2e3beb8L + (int128)tmpQ[15] * 0x6eaa78fb7420L + (int128)tmpQ[16] * -0x7c8a225b899aL;
	tmpZero[11] = (int128)tmpQ[0] * -0x3e45112dc4cdL + (int128)tmpQ[1] * 0x2caf3d1db643L + (int128)tmpQ[2] * 0x233b977b8176L + (int128)tmpQ[3] * -0x100f958d7016L + (int128)tmpQ[4] * -0x1f16c2c74509L + (int128)tmpQ[5] * -0xcdbcc129b3aL + (int128)tmpQ[6] * -0x1773bb7ab0a9L + (int128)tmpQ[7] * 0x2231d8f61e49L + (int128)tmpQ[8] * 0x3105b2e99517L + (int128)tmpQ[9] * 0x1ec2ac6c1061L + (int128)tmpQ[10] * 0x821483b2e26L + (int128)tmpQ[11] * 0x497e98f70c47L + (int128)tmpQ[12] * 0x5fd612626f6cL + (int128)tmpQ[13] * -0xb6f7c3eba830L + (int128)tmpQ[14] * 0x6ab7650a4baeL + (int128)tmpQ[15] * -0x1964a2e3beb8L + (int128)tmpQ[16] * 0x6eaa78fb7420L;
	tmpZero[12] = (int128)tmpQ[0] * 0x37553c7dba10L + (int128)tmpQ[1] * -0x3e45112dc4cdL + (int128)tmpQ[2] * 0x2caf3d1db643L + (int128)tmpQ[3] * 0x233b977b8176L + (int128)tmpQ[4] * -0x100f958d7016L + (int128)tmpQ[5] * -0x1f16c2c74509L + (int128)tmpQ[6] * -0xcdbcc129b3aL + (int128)tmpQ[7] * -0x1773bb7ab0a9L + (int128)tmpQ[8] * 0x2231d8f61e49L + (int128)tmpQ[9] * 0x3105b2e99517L + (int128)tmpQ[10] * 0x1ec2ac6c1061L + (int128)tmpQ[11] * 0x821483b2e26L + (int128)tmpQ[12] * 0x497e98f70c47L + (int128)tmpQ[13] * 0x5fd612626f6cL + (int128)tmpQ[14] * -0xb6f7c3eba830L + (int128)tmpQ[15] * 0x6ab7650a4baeL + (int128)tmpQ[16] * -0x1964a2e3beb8L;
	tmpZero[13] = (int128)tmpQ[0] * -0xcb25171df5cL + (int128)tmpQ[1] * 0x37553c7dba10L + (int128)tmpQ[2] * -0x3e45112dc4cdL + (int128)tmpQ[3] * 0x2caf3d1db643L + (int128)tmpQ[4] * 0x233b977b8176L + (int128)tmpQ[5] * -0x100f958d7016L + (int128)tmpQ[6] * -0x1f16c2c74509L + (int128)tmpQ[7] * -0xcdbcc129b3aL + (int128)tmpQ[8] * -0x1773bb7ab0a9L + (int128)tmpQ[9] * 0x2231d8f61e49L + (int128)tmpQ[10] * 0x3105b2e99517L + (int128)tmpQ[11] * 0x1ec2ac6c1061L + (int128)tmpQ[12] * 0x821483b2e26L + (int128)tmpQ[13] * 0x497e98f70c47L + (int128)tmpQ[14] * 0x5fd612626f6cL + (int128)tmpQ[15] * -0xb6f7c3eba830L + (int128)tmpQ[16] * 0x6ab7650a4baeL;
	tmpZero[14] = (int128)tmpQ[0] * 0x355bb28525d7L + (int128)tmpQ[1] * -0xcb25171df5cL + (int128)tmpQ[2] * 0x37553c7dba10L + (int128)tmpQ[3] * -0x3e45112dc4cdL + (int128)tmpQ[4] * 0x2caf3d1db643L + (int128)tmpQ[5] * 0x233b977b8176L + (int128)tmpQ[6] * -0x100f958d7016L + (int128)tmpQ[7] * -0x1f16c2c74509L + (int128)tmpQ[8] * -0xcdbcc129b3aL + (int128)tmpQ[9] * -0x1773bb7ab0a9L + (int128)tmpQ[10] * 0x2231d8f61e49L + (int128)tmpQ[11] * 0x3105b2e99517L + (int128)tmpQ[12] * 0x1ec2ac6c1061L + (int128)tmpQ[13] * 0x821483b2e26L + (int128)tmpQ[14] * 0x497e98f70c47L + (int128)tmpQ[15] * 0x5fd612626f6cL + (int128)tmpQ[16] * -0xb6f7c3eba830L;
	tmpZero[15] = (int128)tmpQ[0] * -0x5b7be1f5d418L + (int128)tmpQ[1] * 0x355bb28525d7L + (int128)tmpQ[2] * -0xcb25171df5cL + (int128)tmpQ[3] * 0x37553c7dba10L + (int128)tmpQ[4] * -0x3e45112dc4cdL + (int128)tmpQ[5] * 0x2caf3d1db643L + (int128)tmpQ[6] * 0x233b977b8176L + (int128)tmpQ[7] * -0x100f958d7016L + (int128)tmpQ[8] * -0x1f16c2c74509L + (int128)tmpQ[9] * -0xcdbcc129b3aL + (int128)tmpQ[10] * -0x1773bb7ab0a9L + (int128)tmpQ[11] * 0x2231d8f61e49L + (int128)tmpQ[12] * 0x3105b2e99517L + (int128)tmpQ[13] * 0x1ec2ac6c1061L + (int128)tmpQ[14] * 0x821483b2e26L + (int128)tmpQ[15] * 0x497e98f70c47L + (int128)tmpQ[16] * 0x5fd612626f6cL;
	tmpZero[16] = (int128)tmpQ[0] * 0x2feb093137b6L + (int128)tmpQ[1] * -0x5b7be1f5d418L + (int128)tmpQ[2] * 0x355bb28525d7L + (int128)tmpQ[3] * -0xcb25171df5cL + (int128)tmpQ[4] * 0x37553c7dba10L + (int128)tmpQ[5] * -0x3e45112dc4cdL + (int128)tmpQ[6] * 0x2caf3d1db643L + (int128)tmpQ[7] * 0x233b977b8176L + (int128)tmpQ[8] * -0x100f958d7016L + (int128)tmpQ[9] * -0x1f16c2c74509L + (int128)tmpQ[10] * -0xcdbcc129b3aL + (int128)tmpQ[11] * -0x1773bb7ab0a9L + (int128)tmpQ[12] * 0x2231d8f61e49L + (int128)tmpQ[13] * 0x3105b2e99517L + (int128)tmpQ[14] * 0x1ec2ac6c1061L + (int128)tmpQ[15] * 0x821483b2e26L + (int128)tmpQ[16] * 0x497e98f70c47L;

	//~ computation of : (op + tmp_zero)/mont_phi
	rop[0] = (op[0] + tmpZero[0]) >> PHI_LOG2;
	rop[1] = (op[1] + tmpZero[1]) >> PHI_LOG2;
	rop[2] = (op[2] + tmpZero[2]) >> PHI_LOG2;
	rop[3] = (op[3] + tmpZero[3]) >> PHI_LOG2;
	rop[4] = (op[4] + tmpZero[4]) >> PHI_LOG2;
	rop[5] = (op[5] + tmpZero[5]) >> PHI_LOG2;
	rop[6] = (op[6] + tmpZero[6]) >> PHI_LOG2;
	rop[7] = (op[7] + tmpZero[7]) >> PHI_LOG2;
	rop[8] = (op[8] + tmpZero[8]) >> PHI_LOG2;
	rop[9] = (op[9] + tmpZero[9]) >> PHI_LOG2;
	rop[10] = (op[10] + tmpZero[10]) >> PHI_LOG2;
	rop[11] = (op[11] + tmpZero[11]) >> PHI_LOG2;
	rop[12] = (op[12] + tmpZero[12]) >> PHI_LOG2;
	rop[13] = (op[13] + tmpZero[13]) >> PHI_LOG2;
	rop[14] = (op[14] + tmpZero[14]) >> PHI_LOG2;
	rop[15] = (op[15] + tmpZero[15]) >> PHI_LOG2;
	rop[16] = (op[16] + tmpZero[16]) >> PHI_LOG2;
}

void exact_coeffs_reduction(int64_t *rop, int64_t *op){

	int i;
	int128 tmp[NB_COEFF];

	for(i=0; i<NB_COEFF; i++)
		tmp[i] = (int128) op[i];

	internal_reduction(rop, tmp);

	tmp[0] = (int128)rop[0] * polys_P[0][0] + (((int128)rop[1] * polys_P[0][16] + (int128)rop[2] * polys_P[0][15] + (int128)rop[3] * polys_P[0][14] + (int128)rop[4] * polys_P[0][13] + (int128)rop[5] * polys_P[0][12] + (int128)rop[6] * polys_P[0][11] + (int128)rop[7] * polys_P[0][10] + (int128)rop[8] * polys_P[0][9] + (int128)rop[9] * polys_P[0][8] + (int128)rop[10] * polys_P[0][7] + (int128)rop[11] * polys_P[0][6] + (int128)rop[12] * polys_P[0][5] + (int128)rop[13] * polys_P[0][4] + (int128)rop[14] * polys_P[0][3] + (int128)rop[15] * polys_P[0][2] + (int128)rop[16] * polys_P[0][1]) << 1);
	tmp[1] = (int128)rop[0] * polys_P[0][1] + (int128)rop[1] * polys_P[0][0] + (((int128)rop[2] * polys_P[0][16] + (int128)rop[3] * polys_P[0][15] + (int128)rop[4] * polys_P[0][14] + (int128)rop[5] * polys_P[0][13] + (int128)rop[6] * polys_P[0][12] + (int128)rop[7] * polys_P[0][11] + (int128)rop[8] * polys_P[0][10] + (int128)rop[9] * polys_P[0][9] + (int128)rop[10] * polys_P[0][8] + (int128)rop[11] * polys_P[0][7] + (int128)rop[12] * polys_P[0][6] + (int128)rop[13] * polys_P[0][5] + (int128)rop[14] * polys_P[0][4] + (int128)rop[15] * polys_P[0][3] + (int128)rop[16] * polys_P[0][2]) << 1);
	tmp[2] = (int128)rop[0] * polys_P[0][2] + (int128)rop[1] * polys_P[0][1] + (int128)rop[2] * polys_P[0][0] + (((int128)rop[3] * polys_P[0][16] + (int128)rop[4] * polys_P[0][15] + (int128)rop[5] * polys_P[0][14] + (int128)rop[6] * polys_P[0][13] + (int128)rop[7] * polys_P[0][12] + (int128)rop[8] * polys_P[0][11] + (int128)rop[9] * polys_P[0][10] + (int128)rop[10] * polys_P[0][9] + (int128)rop[11] * polys_P[0][8] + (int128)rop[12] * polys_P[0][7] + (int128)rop[13] * polys_P[0][6] + (int128)rop[14] * polys_P[0][5] + (int128)rop[15] * polys_P[0][4] + (int128)rop[16] * polys_P[0][3]) << 1);
	tmp[3] = (int128)rop[0] * polys_P[0][3] + (int128)rop[1] * polys_P[0][2] + (int128)rop[2] * polys_P[0][1] + (int128)rop[3] * polys_P[0][0] + (((int128)rop[4] * polys_P[0][16] + (int128)rop[5] * polys_P[0][15] + (int128)rop[6] * polys_P[0][14] + (int128)rop[7] * polys_P[0][13] + (int128)rop[8] * polys_P[0][12] + (int128)rop[9] * polys_P[0][11] + (int128)rop[10] * polys_P[0][10] + (int128)rop[11] * polys_P[0][9] + (int128)rop[12] * polys_P[0][8] + (int128)rop[13] * polys_P[0][7] + (int128)rop[14] * polys_P[0][6] + (int128)rop[15] * polys_P[0][5] + (int128)rop[16] * polys_P[0][4]) << 1);
	tmp[4] = (int128)rop[0] * polys_P[0][4] + (int128)rop[1] * polys_P[0][3] + (int128)rop[2] * polys_P[0][2] + (int128)rop[3] * polys_P[0][1] + (int128)rop[4] * polys_P[0][0] + (((int128)rop[5] * polys_P[0][16] + (int128)rop[6] * polys_P[0][15] + (int128)rop[7] * polys_P[0][14] + (int128)rop[8] * polys_P[0][13] + (int128)rop[9] * polys_P[0][12] + (int128)rop[10] * polys_P[0][11] + (int128)rop[11] * polys_P[0][10] + (int128)rop[12] * polys_P[0][9] + (int128)rop[13] * polys_P[0][8] + (int128)rop[14] * polys_P[0][7] + (int128)rop[15] * polys_P[0][6] + (int128)rop[16] * polys_P[0][5]) << 1);
	tmp[5] = (int128)rop[0] * polys_P[0][5] + (int128)rop[1] * polys_P[0][4] + (int128)rop[2] * polys_P[0][3] + (int128)rop[3] * polys_P[0][2] + (int128)rop[4] * polys_P[0][1] + (int128)rop[5] * polys_P[0][0] + (((int128)rop[6] * polys_P[0][16] + (int128)rop[7] * polys_P[0][15] + (int128)rop[8] * polys_P[0][14] + (int128)rop[9] * polys_P[0][13] + (int128)rop[10] * polys_P[0][12] + (int128)rop[11] * polys_P[0][11] + (int128)rop[12] * polys_P[0][10] + (int128)rop[13] * polys_P[0][9] + (int128)rop[14] * polys_P[0][8] + (int128)rop[15] * polys_P[0][7] + (int128)rop[16] * polys_P[0][6]) << 1);
	tmp[6] = (int128)rop[0] * polys_P[0][6] + (int128)rop[1] * polys_P[0][5] + (int128)rop[2] * polys_P[0][4] + (int128)rop[3] * polys_P[0][3] + (int128)rop[4] * polys_P[0][2] + (int128)rop[5] * polys_P[0][1] + (int128)rop[6] * polys_P[0][0] + (((int128)rop[7] * polys_P[0][16] + (int128)rop[8] * polys_P[0][15] + (int128)rop[9] * polys_P[0][14] + (int128)rop[10] * polys_P[0][13] + (int128)rop[11] * polys_P[0][12] + (int128)rop[12] * polys_P[0][11] + (int128)rop[13] * polys_P[0][10] + (int128)rop[14] * polys_P[0][9] + (int128)rop[15] * polys_P[0][8] + (int128)rop[16] * polys_P[0][7]) << 1);
	tmp[7] = (int128)rop[0] * polys_P[0][7] + (int128)rop[1] * polys_P[0][6] + (int128)rop[2] * polys_P[0][5] + (int128)rop[3] * polys_P[0][4] + (int128)rop[4] * polys_P[0][3] + (int128)rop[5] * polys_P[0][2] + (int128)rop[6] * polys_P[0][1] + (int128)rop[7] * polys_P[0][0] + (((int128)rop[8] * polys_P[0][16] + (int128)rop[9] * polys_P[0][15] + (int128)rop[10] * polys_P[0][14] + (int128)rop[11] * polys_P[0][13] + (int128)rop[12] * polys_P[0][12] + (int128)rop[13] * polys_P[0][11] + (int128)rop[14] * polys_P[0][10] + (int128)rop[15] * polys_P[0][9] + (int128)rop[16] * polys_P[0][8]) << 1);
	tmp[8] = (int128)rop[0] * polys_P[0][8] + (int128)rop[1] * polys_P[0][7] + (int128)rop[2] * polys_P[0][6] + (int128)rop[3] * polys_P[0][5] + (int128)rop[4] * polys_P[0][4] + (int128)rop[5] * polys_P[0][3] + (int128)rop[6] * polys_P[0][2] + (int128)rop[7] * polys_P[0][1] + (int128)rop[8] * polys_P[0][0] + (((int128)rop[9] * polys_P[0][16] + (int128)rop[10] * polys_P[0][15] + (int128)rop[11] * polys_P[0][14] + (int128)rop[12] * polys_P[0][13] + (int128)rop[13] * polys_P[0][12] + (int128)rop[14] * polys_P[0][11] + (int128)rop[15] * polys_P[0][10] + (int128)rop[16] * polys_P[0][9]) << 1);
	tmp[9] = (int128)rop[0] * polys_P[0][9] + (int128)rop[1] * polys_P[0][8] + (int128)rop[2] * polys_P[0][7] + (int128)rop[3] * polys_P[0][6] + (int128)rop[4] * polys_P[0][5] + (int128)rop[5] * polys_P[0][4] + (int128)rop[6] * polys_P[0][3] + (int128)rop[7] * polys_P[0][2] + (int128)rop[8] * polys_P[0][1] + (int128)rop[9] * polys_P[0][0] + (((int128)rop[10] * polys_P[0][16] + (int128)rop[11] * polys_P[0][15] + (int128)rop[12] * polys_P[0][14] + (int128)rop[13] * polys_P[0][13] + (int128)rop[14] * polys_P[0][12] + (int128)rop[15] * polys_P[0][11] + (int128)rop[16] * polys_P[0][10]) << 1);
	tmp[10] = (int128)rop[0] * polys_P[0][10] + (int128)rop[1] * polys_P[0][9] + (int128)rop[2] * polys_P[0][8] + (int128)rop[3] * polys_P[0][7] + (int128)rop[4] * polys_P[0][6] + (int128)rop[5] * polys_P[0][5] + (int128)rop[6] * polys_P[0][4] + (int128)rop[7] * polys_P[0][3] + (int128)rop[8] * polys_P[0][2] + (int128)rop[9] * polys_P[0][1] + (int128)rop[10] * polys_P[0][0] + (((int128)rop[11] * polys_P[0][16] + (int128)rop[12] * polys_P[0][15] + (int128)rop[13] * polys_P[0][14] + (int128)rop[14] * polys_P[0][13] + (int128)rop[15] * polys_P[0][12] + (int128)rop[16] * polys_P[0][11]) << 1);
	tmp[11] = (int128)rop[0] * polys_P[0][11] + (int128)rop[1] * polys_P[0][10] + (int128)rop[2] * polys_P[0][9] + (int128)rop[3] * polys_P[0][8] + (int128)rop[4] * polys_P[0][7] + (int128)rop[5] * polys_P[0][6] + (int128)rop[6] * polys_P[0][5] + (int128)rop[7] * polys_P[0][4] + (int128)rop[8] * polys_P[0][3] + (int128)rop[9] * polys_P[0][2] + (int128)rop[10] * polys_P[0][1] + (int128)rop[11] * polys_P[0][0] + (((int128)rop[12] * polys_P[0][16] + (int128)rop[13] * polys_P[0][15] + (int128)rop[14] * polys_P[0][14] + (int128)rop[15] * polys_P[0][13] + (int128)rop[16] * polys_P[0][12]) << 1);
	tmp[12] = (int128)rop[0] * polys_P[0][12] + (int128)rop[1] * polys_P[0][11] + (int128)rop[2] * polys_P[0][10] + (int128)rop[3] * polys_P[0][9] + (int128)rop[4] * polys_P[0][8] + (int128)rop[5] * polys_P[0][7] + (int128)rop[6] * polys_P[0][6] + (int128)rop[7] * polys_P[0][5] + (int128)rop[8] * polys_P[0][4] + (int128)rop[9] * polys_P[0][3] + (int128)rop[10] * polys_P[0][2] + (int128)rop[11] * polys_P[0][1] + (int128)rop[12] * polys_P[0][0] + (((int128)rop[13] * polys_P[0][16] + (int128)rop[14] * polys_P[0][15] + (int128)rop[15] * polys_P[0][14] + (int128)rop[16] * polys_P[0][13]) << 1);
	tmp[13] = (int128)rop[0] * polys_P[0][13] + (int128)rop[1] * polys_P[0][12] + (int128)rop[2] * polys_P[0][11] + (int128)rop[3] * polys_P[0][10] + (int128)rop[4] * polys_P[0][9] + (int128)rop[5] * polys_P[0][8] + (int128)rop[6] * polys_P[0][7] + (int128)rop[7] * polys_P[0][6] + (int128)rop[8] * polys_P[0][5] + (int128)rop[9] * polys_P[0][4] + (int128)rop[10] * polys_P[0][3] + (int128)rop[11] * polys_P[0][2] + (int128)rop[12] * polys_P[0][1] + (int128)rop[13] * polys_P[0][0] + (((int128)rop[14] * polys_P[0][16] + (int128)rop[15] * polys_P[0][15] + (int128)rop[16] * polys_P[0][14]) << 1);
	tmp[14] = (int128)rop[0] * polys_P[0][14] + (int128)rop[1] * polys_P[0][13] + (int128)rop[2] * polys_P[0][12] + (int128)rop[3] * polys_P[0][11] + (int128)rop[4] * polys_P[0][10] + (int128)rop[5] * polys_P[0][9] + (int128)rop[6] * polys_P[0][8] + (int128)rop[7] * polys_P[0][7] + (int128)rop[8] * polys_P[0][6] + (int128)rop[9] * polys_P[0][5] + (int128)rop[10] * polys_P[0][4] + (int128)rop[11] * polys_P[0][3] + (int128)rop[12] * polys_P[0][2] + (int128)rop[13] * polys_P[0][1] + (int128)rop[14] * polys_P[0][0] + (((int128)rop[15] * polys_P[0][16] + (int128)rop[16] * polys_P[0][15]) << 1);
	tmp[15] = (int128)rop[0] * polys_P[0][15] + (int128)rop[1] * polys_P[0][14] + (int128)rop[2] * polys_P[0][13] + (int128)rop[3] * polys_P[0][12] + (int128)rop[4] * polys_P[0][11] + (int128)rop[5] * polys_P[0][10] + (int128)rop[6] * polys_P[0][9] + (int128)rop[7] * polys_P[0][8] + (int128)rop[8] * polys_P[0][7] + (int128)rop[9] * polys_P[0][6] + (int128)rop[10] * polys_P[0][5] + (int128)rop[11] * polys_P[0][4] + (int128)rop[12] * polys_P[0][3] + (int128)rop[13] * polys_P[0][2] + (int128)rop[14] * polys_P[0][1] + (int128)rop[15] * polys_P[0][0] + (((int128)rop[16] * polys_P[0][16]) << 1);
	tmp[16] = (int128)rop[0] * polys_P[0][16] + (int128)rop[1] * polys_P[0][15] + (int128)rop[2] * polys_P[0][14] + (int128)rop[3] * polys_P[0][13] + (int128)rop[4] * polys_P[0][12] + (int128)rop[5] * polys_P[0][11] + (int128)rop[6] * polys_P[0][10] + (int128)rop[7] * polys_P[0][9] + (int128)rop[8] * polys_P[0][8] + (int128)rop[9] * polys_P[0][7] + (int128)rop[10] * polys_P[0][6] + (int128)rop[11] * polys_P[0][5] + (int128)rop[12] * polys_P[0][4] + (int128)rop[13] * polys_P[0][3] + (int128)rop[14] * polys_P[0][2] + (int128)rop[15] * polys_P[0][1] + (int128)rop[16] * polys_P[0][0];

	internal_reduction(rop, tmp);
}

